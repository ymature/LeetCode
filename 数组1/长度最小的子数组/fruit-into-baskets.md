## 904. 水果成篮

#### 题目描述

你正在探访一家农场，农场从左到右种植了一排果树。这些树用一个整数数组 fruits 表示，其中 fruits[i] 是第 i 棵树上的水果 种类 。

你想要尽可能多地收集水果。然而，农场的主人设定了一些严格的规矩，你必须按照要求采摘水果：

- 你只有 **两个** 篮子，并且每个篮子只能装 **单一类型** 的水果。每个篮子能够装的水果总量没有限制。

- 你可以选择任意一棵树开始采摘，你必须从 **每棵** 树（包括开始采摘的树）上 **恰好摘一个水果** 。采摘的水果应当符合篮子中的水果类型。每采摘一次，你将会向右移动到下一棵树，并继续采摘。
- 一旦你走到某棵树前，但水果不符合篮子的水果类型，那么就必须停止采摘。
给你一个整数数组 fruits ，返回你可以收集的水果的 **最大** 数目。

 ```python
 示例 1：
 
 输入：fruits = [1,2,1]
 输出：3
 解释：可以采摘全部 3 棵树。
 示例 2：
 
 输入：fruits = [0,1,2,2]
 输出：3
 解释：可以采摘 [1,2,2] 这三棵树。
 如果从第一棵树开始采摘，则只能采摘 [0,1] 这两棵树。
 示例 3：
 
 输入：fruits = [1,2,3,2,2]
 输出：4
 解释：可以采摘 [2,3,2,2] 这四棵树。
 如果从第一棵树开始采摘，则只能采摘 [1,2] 这两棵树。
 示例 4：
 
 输入：fruits = [3,3,3,1,2,1,1,2,3,3,4]
 输出：5
 解释：可以采摘 [1,2,1,1,2] 这五棵树。
 ```

**提示**

- `1 <= fruits.length <= 105`
- `0 <= fruits[i] < fruits.length`

##### 思路

使用**滑动窗口**（**start、end**指针分别指向滑动窗口的**左边和右边**）遍历每一种可能的序列，选择长度最长的序列。

注：当遇到**第三种**水果时，为保证窗口中只有两种水果，滑动窗口的左边必须变更为最近的水果种类。例如：

序列：[3,3,3,1,1,2,1,1,2,3,3,4]，只有两种水果时，第一个序列为：[3,3,3,1,1]；有三种水果时，序列的为[3,3,3,1,1,2]；滑动窗口的左边变更为**第一个**`1`所在位置，确保序列中只有两种水果。

窗口中的值： 只有两种水果的序列

窗口起始位置移动：当窗口中有**三种**水果时，为确保窗口中只有两种水果，起始位置移动到最近的水果种类处（如上解析）

窗口终止位置移动：每次循环向前移动一位，判断该**fruit[end]**是否为新的一种水果。因此，需要一个大小为2的一维数组记录窗口内的水果种类。

##### 参考答案

```python
class Solution:
    def totalFruit(self, fruits: List[int]) -> int:
        if fruits is None or len(fruits) == 0:
            return 0
        start = end = 0
        n = 0 # 用以记录最近的水果种类位置
        num = 0 
        vary = []
        while end < len(fruits):
            if fruits[end] not in vary:
                if len(vary) < 2:
                    vary.append(fruits[end])
                else : # 窗口中出现三种水果
                    start = n # 窗口左边变更为最近的水果种类位置
                    # 记录窗口中的水果种类，由于fruit[end]不在vary中，说明是第三种水果，则fruit[end - 1]必定是不同于fruit[end]的水果，则新窗口的水果种类是fruit[end - 1]和fruit[end]
                    vary[0] = fruits[end - 1]
                    vary[1] = fruits[end]
            # 记录窗口中最新的水果种类位置为n，作为最近的水果种类位置
            if fruits[end] != fruits[n]:
                n = end
            num = max(num, end - start + 1) 
            end += 1   
        return num
```

